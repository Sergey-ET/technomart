const cartButton = document.querySelectorAll(".product-button-buy"),
  cartPopup = document.querySelector(".modal-cart"),
  cartClose = cartPopup.querySelector(".modal-close"),
  cartContinueButton = cartPopup.querySelector(".modal-cart-button");
cartButton.forEach(function (e) {
  e.addEventListener("click", function (e) {
    e.preventDefault(), cartPopup.classList.add("modal-show");
  });
}),
  cartClose.addEventListener("click", function (e) {
    e.preventDefault(), cartPopup.classList.remove("modal-show");
  }),
  cartContinueButton.addEventListener("click", function (e) {
    e.preventDefault(), cartPopup.classList.remove("modal-show");
  }),
  window.addEventListener("keydown", function (e) {
    27 === e.keyCode &&
      cartPopup.classList.contains("modal-show") &&
      (e.preventDefault(), cartPopup.classList.remove("modal-show"));
  });
const feedbackButton = document.querySelector(".contacts-button"),
  feedbackPopup = document.querySelector(".modal-feedback"),
  feedbackClose = feedbackPopup.querySelector(".modal-close"),
  feedbackForm = feedbackPopup.querySelector(".feedback-form"),
  feedbackName = feedbackPopup.querySelector(".feedback-input-name"),
  feedbackEmail = feedbackPopup.querySelector(".feedback-input-email"),
  feedbackMessage = feedbackPopup.querySelector(".feedback-input-message"),
  mapLink = document.querySelector(".contacts-map"),
  mapPopup = document.querySelector(".modal-map"),
  mapClose = mapPopup.querySelector(".modal-close");
let isStorageSupport = !0,
  storageName = "",
  storageEmail = "";
try {
  (storageName = localStorage.getItem("name")),
    (storageEmail = localStorage.getItem("email"));
} catch (e) {
  isStorageSupport = !1;
}
feedbackButton.addEventListener("click", function (e) {
  e.preventDefault(),
    feedbackPopup.classList.add("modal-show"),
    storageName && storageEmail
      ? ((feedbackName.value = storageName),
        (feedbackEmail.value = storageEmail),
        feedbackMessage.focus())
      : feedbackName.focus();
}),
  feedbackClose.addEventListener("click", function (e) {
    e.preventDefault(),
      feedbackPopup.classList.remove("modal-show"),
      feedbackPopup.classList.remove("modal-error");
  }),
  feedbackForm.addEventListener("submit", function (e) {
    feedbackName.value && feedbackEmail.value && feedbackMessage.value
      ? isStorageSupport &&
        (localStorage.setItem("name", feedbackName.value),
        localStorage.setItem("email", feedbackEmail.value))
      : (e.preventDefault(),
        feedbackPopup.classList.remove("modal-error"),
        (feedbackPopup.offsetWidth = feedbackPopup.offsetWidth),
        feedbackPopup.classList.add("modal-error"));
  }),
  window.addEventListener("keydown", function (e) {
    27 === e.keyCode &&
      feedbackPopup.classList.contains("modal-show") &&
      (e.preventDefault(),
      feedbackPopup.classList.remove("modal-show"),
      feedbackPopup.classList.remove("modal-error"));
  }),
  mapLink.addEventListener("click", function (e) {
    e.preventDefault(), mapPopup.classList.add("modal-show");
  }),
  mapClose.addEventListener("click", function (e) {
    e.preventDefault(), mapPopup.classList.remove("modal-show");
  }),
  window.addEventListener("keydown", function (e) {
    27 === e.keyCode &&
      mapPopup.classList.contains("modal-show") &&
      (e.preventDefault(), mapPopup.classList.remove("modal-show"));
  });
